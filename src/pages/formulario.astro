---
import Header from '@components/Header.astro';
import Footer from '@components/Footer.astro';
/* import Layout from '@layouts/Layout.astro'; */
import PageLayout from '@layouts/PageLayout.astro';
// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// Don't want to use any of this? Delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.
---

<PageLayout>
	<div class="add-item-container">
  <div class="image-preview-column">
    <div id="imagePreview" class="image-preview-box">
      <span class="preview-text">preview imagen</span>
      <img src="" alt="Previsualización de portada" style="display: none;" />
    </div>
  </div>

  <div class="form-column">
    <form id="addItemForm">
      <h3>Añadir a mi lista</h3>

      <div class="form-group">
        <label for="coverImageUrl">URL de imagen portada</label>
        <input type="url" id="coverImageUrl" name="coverImageUrl" placeholder="https://ejemplo.com/imagen.jpg" />
      </div>

      <div class="form-group">
        <label for="itemName">Nombre</label>
        <input type="text" id="itemName" name="itemName" placeholder="Nombre de la serie/película" />
      </div>

      <div class="form-row">
        <div class="form-group half-width">
          <label for="seasons">Temporadas</label>
          <input type="number" id="seasons" name="seasons" placeholder="Ej: 3" min="0" />
        </div>
        <div class="form-group half-width">
          <label for="chapters">Capítulos</label>
          <input type="number" id="chapters" name="chapters" placeholder="Ej: 24" min="0" />
        </div>
      </div>

      <div class="form-group">
        <label for="synopsis">Sinopsis</label>
        <textarea id="synopsis" name="synopsis" rows="4" placeholder="Breve descripción..."></textarea>
      </div>

      <h4>Campos adicionales</h4>

      <div class="form-group">
        <label for="rating">Calificación</label>
        <input type="number" id="rating" name="rating" placeholder="Ej: 8.5" step="0.1" min="0" max="10" />
      </div>

      <div class="form-group">
        <label for="genres">Géneros</label>
        <input type="text" id="genres" name="genres" placeholder="Ej: Acción, Comedia, Drama" />
      </div>

      <div class="form-row">
        <div class="form-group half-width">
          <label for="year">Año</label>
          <input type="number" id="year" name="year" placeholder="Ej: 2023" min="1900" max="2099" />
        </div>
        <div class="form-group half-width">
          <label for="durationPerChapter">d. por cap. (min)</label>
          <input type="number" id="durationPerChapter" name="durationPerChapter" placeholder="Ej: 24" min="0" />
        </div>
      </div>

      <div class="form-group">
        <label for="trailerUrl">URL tráiler</label>
        <input type="url" id="trailerUrl" name="trailerUrl" placeholder="https://youtube.com/watch?v=..." />
      </div>

      <button type="submit" class="save-button">Guardar</button>
    </form>
  </div>
</div>

<style>
body { 
  background-color: #E0E0E0; 
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  color: #333333; 
  padding: 20px; 
}

.add-item-container {
  display: flex;
  max-width: 900px; 
  margin: 20px auto;
  background-color: #E0E0E0; 
  border-radius: 8px;
  overflow: hidden; 
}

.image-preview-column {
  flex: 1; 
  padding: 20px;
  background-color: #D0D0D0; 
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 500px; 
}

.image-preview-box {
  width: 100%;
  height: 100%;
  max-height: 450px; 
  border: 2px dashed #B0B0B0; 
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  background-color: #C8C8C8; 
  border-radius: 6px;
  position: relative; 
  overflow: hidden;
}

.image-preview-box .preview-text {
  color: #757575; 
  font-size: 1.2rem;
}

.image-preview-box img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain; 
  display: block; 
}

.form-column {
  flex: 1.5; 
  padding: 30px;
  background-color: #EDEDED; 
  border-left: 1px solid #C0C0C0; 
}

.form-column h3, .form-column h4 {
  color: #424242; 
  margin-top: 0;
  margin-bottom: 15px;
}
.form-column h3 {
  font-size: 1.5rem;
  text-align: center;
  margin-bottom: 25px;
}
.form-column h4 {
  font-size: 1rem;
  margin-top: 25px;
  border-bottom: 1px solid #D0D0D0;
  padding-bottom: 5px;
}


.form-group {
  margin-bottom: 15px;
}

.form-group label {
  display: block;
  font-size: 0.85rem;
  color: #616161; 
  margin-bottom: 5px;
  font-weight: 500;
}

.form-group input[type="text"],
.form-group input[type="url"],
.form-group input[type="number"],
.form-group textarea {
  width: 100%;
  padding: 10px;
  border: 1px solid #C8C8C8; 
  background-color: #F5F5F5; 
  border-radius: 4px;
  box-sizing: border-box;
  font-size: 0.95rem;
  color: #333333;
}

.form-group input::placeholder,
.form-group textarea::placeholder {
  color: #9E9E9E; 
}

.form-group input:focus,
.form-group textarea:focus {
  outline: none;
  border-color: #757575; 
  background-color: #FFFFFF; 
  box-shadow: 0 0 0 2px rgba(117, 117, 117, 0.2); 
}

.form-group textarea {
  resize: vertical; 
  min-height: 80px;
}

.form-row {
  display: flex;
  gap: 15px; 
}

.form-row .form-group.half-width {
  flex: 1; 
}

.save-button {
  width: 100%;
  padding: 12px;
  background-color: #BDBDBD; 
  color: #424242; 
  border: none;
  border-radius: 6px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: background-color 0.2s ease-in-out;
  margin-top: 20px;
}

.save-button:hover {
  background-color: #A0A0A0; 
}


@media (max-width: 768px) {
  .add-item-container {
    flex-direction: column;
  }
  .image-preview-column {
    min-height: 300px; 
    border-bottom: 1px solid #C0C0C0; 
    border-left: none;
  }
  .image-preview-box {
    max-height: 280px;
  }
  .form-column {
    border-left: none;
  }
}</style>




<script>
  

  
  const addItemForm = document.getElementById('addItemForm') as HTMLFormElement | null;
  const coverImageUrlInput = document.getElementById('coverImageUrl') as HTMLInputElement | null;
  const imagePreviewBox = document.getElementById('imagePreview') as HTMLElement | null;

  
  const imageElement = imagePreviewBox ? imagePreviewBox.querySelector('img') as HTMLImageElement | null : null;
  const previewText = imagePreviewBox ? imagePreviewBox.querySelector('.preview-text') as HTMLElement | null : null;

  
  if (coverImageUrlInput && imagePreviewBox && imageElement && previewText) {
    coverImageUrlInput.addEventListener('input', function() {
      
      
      const url = this.value.trim();

      if (url) {
        imageElement.src = url; 
        imageElement.style.display = 'block'; 
        previewText.style.display = 'none';

        imageElement.onerror = function() {
        
         
          imageElement.style.display = 'none';
          previewText.style.display = 'block';
         
          if(previewText) previewText.textContent = 'Error al cargar imagen';
        };
      } else {
        imageElement.style.display = 'none';
        imageElement.src = '';
        previewText.style.display = 'block';
        if(previewText) previewText.textContent = 'preview imagen';
      }
    });
  }

  if (addItemForm) {
    addItemForm.addEventListener('submit', function(event) {
      event.preventDefault();

      const itemNameInput = document.getElementById('itemName') as HTMLInputElement | null;
     
      const itemName = itemNameInput ? itemNameInput.value : '';

      if (!itemName.trim()) {
        alert('El nombre es obligatorio.');
        return; 
      }

      alert('Formulario "Guardado" (simulación). Revisa la consola para ver los datos.');

      
      const formData = new FormData(addItemForm);
      const data = Object.fromEntries(formData.entries());
      console.log('Datos del formulario:', data);

     
    });
  }
</script>
</PLayout>
